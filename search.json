[{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"abstract","dir":"Articles","previous_headings":"","what":"Abstract","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"introduce R package hvtiPlotR, tools creating publication quality graphics R Heart & Vascular Institute Clinical Investigations statistics group Cleveland Clinic. hvtiPlotR package contains tutorial generating figures (vignette) small set functions formatting saving figures. tools describe generate figures R replace plot.sas macro currently use SAS. package vignette tutorial generating standard figures using ggplot2 package commands R. tutorial presents series R recipes generating figures. hvtiPlotR package includes set themes designed format figures inclusion manuscript PowerPoint targets. document included hvtiPlotR package package vignette. vignette installed R hvtiPlotR package installed, viewable using command: vignette(\"hvtiPlotR\", package=\"hvtiPlotR\"). goal vignette tutorial document best practices creating publication quality graphics manuscripts power point presentations. intent update vignette standards hvtiPlotR package modified. Keywords: publication graphics, powerpoint, ggplot2, plot.sas.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"about-this-document","dir":"Articles","previous_headings":"","what":"About this document","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"package vignette introduction R package hvtiPlotR, tutorial creating publication quality graphics R. package document describe process creating graphics R conform standards clinical investigations statistics group within Heart & Vascular Institute Cleveland Clinic. graphics analogous generated plot.sas macro SAS. document package vignette hvtiPlotR package, primary documentation package. latest version document can obtained following command: vignette(\"hvtiPlotR\", package = \"hvtiPlotR\") goal update vignette package, graphing standards, updated. development version hvtiPlotR package also available Github (https://github.com/ehrlinger/hvtiPlotR) package can installed using remotes::install_github(\"ehrlinger/hvtiPlotR\") invite comments, feature requests bug reports package https://github.com/ehrlinger/hvtiPlotR/issues Figure 1: Demonstration figure","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"many years, mainstay generating graphics manuscripts presentations statistics group Heart & Vascular Institute plot.sas macro using SAS. However, recently, issues migrating macro newer versions SAS (> 8.0) Microsoft Oﬃce products (> 2003). eﬀort alleviate version issues, standardize generation figures within R, developed hvtiPlotR R package. goal package, vignette, simplify creation publication quality graphics R. specifically encoding best practices HVTI Clinical Outcomes Research Registries (CORR) formatting, statisticians able create graphics publications presentations minimal amount eﬀort. hvtiPlotR package implements best practices R graphics leveraging ggplot2 package (Wickham 2009). ggplot2 package implementation Grammar Graphics (Wilkinson 2005), formalization graphical concepts, building graphical objects sequence independent components. components can combined many diﬀerent ways. plot.sas macro also implementation graphics grammar. grammar plot.sas derived ZETA pen plotters, used GML (Graphics Machine Language) control 4 8 colored pens generating color line point figures. Listing 1: plot.sas commands: Figure setup. systems use graphics language straight forward exercise translate commands two systems. document outlines generate figures using ggplot2 package R. approach demonstrate R commands generate elements created plot.sas commands. Section 2 gives overview methodology plot.sas macro Section 3 details create line point plots similar ggplot2 commands. hvtiPlotR package contains custom themes figures. figure created using ggplot2 commands, Section 4 details use themes contained hvtiPlotR package get formatting correct manuscripts presentations. Section 5 describes save figures simplify import publication documents.","code":"%let STUDY=/studies/cardiac/valves/aortic/replacement/partner_publication_office/partner1b/mortality_5y *****************************************************************************; * Bring in PostScript plot macro ; filename plt \"! MACROS /plot.sas \"; %inc plt; filename gsasfile pipe 'lp '; *____________________________________________________________________________; * ; * P O S T S C R I P T P L O T S *____________________________________________________________________________; * Multiple decrement , nonparametric and parametric ; filename gsasfile \"&STUDY / graphs /ce. states .ST.ps\"; *____________________________________________________________________________; * Create the figure here ! ; *____________________________________________________________________________; %plot( goptions gsfmode =replace , device =pscolor , gaccess = gsasfile end; id l=\"&STUDY / graphs /ce. states .ST.sas percent \", end; labelx l=\" Years After Randomization \", end; axisx order =(0 to 5 by 1), minor=none , end; labely l=\" Percent in Each Category (ST)\", end; axisy order =(0 to 100 by 10) , minor=none , end;"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"the-plot-sas-macro","dir":"Articles","previous_headings":"","what":"The plot.sas macro","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"first look example code using plot.sas macro. code intended generate figure manuscript publication modified generate Figure 1. walk example code section help us understand steps generating figures R. Note first line code block Listing 1 indicates path specific example file location. filename statements bring plot.sas macro, indicate print, save graphics file. plot.sas macro call starts %plot command. goptions statement first line sets global graphic values, including filename (gaccess=) figure saved (see Section 5). plot.sas command terminated end; statement. ’ll look remaining command type individually. Listing 2: plot.sas commands: points errorbar tuple statements. Listing 3: plot.sas commands: lines tuple statements. id l= command sets footnote text used manuscript figures identify figure saved (see Section 5). labelx labely commands set axis label text (Section 3.3) axisx axisy set scales axis locating text tics (Section 3.4). plot.sas continues Listing 2. , tuple command builds graphics objects within figure plot window. first set tuple commands constructs set three elements containing points (Section 3.5) errorbars (Section 3.6). tuple statement operates dataset indicated set command. Symbols shapes sizes specified symbol symbsize commands (Section 3.9). second set tuple statements Listing 3 construct set three elements containing lines confidence intervals (Section 3.7). plot.sas1 macro code closed ending ); characters, SAS instructed run; code. Running combines building figure combining elements label, axis tuple statements saving file specified gsasfile variable. resulting figure shown Figure 2. Figure 2: Manuscript figure (SAS version) Note much figure formatting mixed within tuple statements using width, color, linepe linecl commands. plot.sas macro, omitting commands generate figure default values specified within plot.sas macro device theme (Section 4). similar set plot.sas commands (Listing 4) used create presentation graphics. Diﬀerences manuscript presentation graphics include target device ftext well handling figure labels value instead label commands. output code shown Figure 3. addition plot.sas commands, also set graphics standards (graphics rules) include presentation graphics, describe rules (Section 6). Many incorporated plot.sas macro protect user violating standards.","code":"******NON - PARAMETRIC : SYMBOLS AND CONFIDENCE BARS ******* tuple set=green , symbol =dot , symbsize =1/2, linepe =0, linecl =0,   ebarsize =3/4, ebar =1, x=iv_state , y=sginit , cll=stlinit ,   clu=stuinit , color=black ,   end;  tuple set=green , symbol =circle , symbsize =1/2, linepe =0, linecl =0,   ebarsize =3/4, ebar =1, x=iv \\_state , y=sgdead1 , cll=stldead1 ,   clu=studead1 , color=blue , end; tuple set=green , symbol =square ,   symbsize =1/2, linepe =0, linecl =0, ebarsize =3/4, ebar =1,   x=iv_state , y=sgstrk1 , cll=stlstrk1 , clu=stustrk1 , color=blue ,   end; /********** PARAMETRIC : SOLID LINES AND CONFIDENCE INTERVALS ********** tuple set=all , x=years , y=noinit , cll=clinit , clu=cuinit , width =0.5 ,   color=black , end; tuple set=all , x=years , y=nodeath , cll=cldeath ,   clu=cudeath , width =0.5 , color=blue , end; tuple set=all , x=years ,   y=nostrk , cll=clstrk , clu=custrk , linecl =2, width =0.5 , color=blue ,   end;"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"generating-ggplot2-graphics","dir":"Articles","previous_headings":"","what":"Generating ggplot2 graphics","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"order create figures similar using plot.sas macro, using R, make extensive use ggplot2 package. require translating graphics language plot.sas graphics language ggplot2. remainder document, R code highlighted grey boxes, shown . refer blocks code chunks. can run code chunk individually, using copy/paste interactive R session, within stand alone R script. tutorial requires hvtiPlotR package load data themes discussing. Listing 4: plot.sas commands: PowerPoint graphics using CGM instructions. Figure 3: PowerPoint figure (SAS version) can install package following commands: document, assume data analysis completed SAS. case, first step creating figures R get data SAS. many ways , success using tp.bd.SAStoR.sas program (datasets folder) export data set SAS xport file. xport file created, read R foreign package. recipe reads xport data.frame re-reads xport file pull SAS labels describe variables. labels stored vector, can index variable names. Referring back SAS code chunks Section 2, Listing 1 sets current working directory, house keeping, including loading plot.sas macro. Similarly, get started R, first load required libraries: ggplot2 graphics, hvtiPlotR themes. following code chunk also sets initial default theme generic black white format, brings pair example datasets. One advantage ggplot2 figures can built successive statements. tutorial make extensive use demonstrate process. Starting code chunk, save intermediate objects ccf_plot variable. simply create empty ggplot2 figure adding work commands plot.sas macro. Note include %plot() commands comments equivalent ggplot2 command comparison. R, set equivalent variables gsmode, device gaccess saving figure (Section 5). next section Listing 1 Section 2 sets x y axis titles, well location major axis tick marks. split R code. ggplot2 package uses labs function set axis labels. labs function can also used set plot title legend titles. cover functionality , details available Wickham (2009) Internet. Axis ticks controlled scale_ functions. ggplot2 many diﬀerent scale_ functions. functions work one axis time, typical continuous axis, use scale_x_continuous scale_y_continuous functions. Major axis controlled using breaks argument. Listing 1 uses sequence numbers set location major tick marks (seq(0,5,1)). One mark every year starting 0, ending 5. Minor tick marks automatically generated, can also specified using minor_breaks= argument. also specify breaks using vector values (c(0,1,2,3,4,5)), well relabel ticks manually using labels= argument. Note scale_ functions restrict figure viewport . simply used setup label axis tick marks. can specify y-axis ticks 0 50, figure blank axis 50 limits data. discuss controlling figure viewport Section 3.11. point, created decorated plot object stored ccf_plot variable. Showing figure (show()) saving figure (ggsave()) result error, since added data object, described want displayed. fundamental statement plot.sas macro tuple statement. first tuple statement see example code sets data set (set=green), symbol shape (symbol=dot), size (symbsize=1/2) color (color=black). Listing 2 turns oﬀ lines points shown (linepe=0, linecl=0,). also handles error bars (ebarsize=3/4, ebar=1), discuss Section 3.6. last line tells macro point placement using vector x y coordinates. Points displayed paired (x, y) error bars specified matching y values upper (clu) lower (cll) error bar limits (x=iv_state, y=sginit, cll=stlinit, clu=stuinit). geom_ set functions ggplot2 functional equivalent tuple statement. diﬀerence user specifies graphical element desired using separate function calls. points plotting using geom_point function, lines generated geom_line (Section 3.7) error bars generated geom_errorbar function (Section 3.6). functions can take data argument well large set decorator arguments (.e. color, size, shape, linetype, . . . ). aesthetic function (aes()) call used describe point within geom_ function using variable names defined data set. following code chunk demonstrates plotting iv_state variable x-axis sginit variable along y-axis. variables defined nonparametric data set loaded setup code chunk Section 3.  aes() mechanism powerful way communicate data level assignment geom_ functions. want stratify dataset variable, can specify within aes() function call using = argument. points, often want stratifying either diﬀerent color= shape= stratified data. can use scale_color_ functions (See Section 3.10) scale_shape_ functions (See Section 3.9) control assigned stratifying variable. added data ggplot object, can display figure shown Figure 4. now figure manipulated sequentially adding function calls ccf_plot object. display figure can either use show() function, simply call object name command line. Note used default shape, size color figure. can manipulated adding arguments geom_ functions, outside aes() function, demonstrate following sections. Instead using single function set points, lines error bars, ggplot uses individual function calls control elements. geom_errorbar function takes arguments geom_ functions. However, since errorbar defined upper lower limits, need supply ymax ymin argument graphic aesthetic function. code chunk plots points, error bars next two data series, sgdead1 variable error bars running stldead1 studead1 sgstrk1 variable error bars running stlstrk1 stustrk1. see Figure 5, series added color=\"blue\" (Section 3.10), diﬀerent point shapes shape=1 shape=0 series (Section 3.9). manipulated error bar size width argument  Note x variable (iv_state) three data series well associated error bars. requirement, specified diﬀerent variable name geom_ function call. Also note just plot.sas macro, since want error bar placed every data point, large number points upper lower error bar y values set missing (NA). ggplot package print warning messages attempt plot series missing values. typically suppress warnings, left illustration purposes . Similar points error bars, geom_line function used plot lines. use linetype argument specify line styles (Section 3.8). generate separate geom_line function call limit confidence limit, since constructed two lines (upper lower confidence limit). resulting graph shown Figure 6.  Alternatively, use geom_ribbon generate confidence band using shaded region single call. aesthetic argument geom_ribbon takes ymax ymin argument just geom_errorbar function. Note used diﬀerent data set (data=parametric) use diﬀerent set points generating lines. linetype argument takes named string value, set diﬀerent line styles. show set frequently used styles Figure 7 reference. shape argument takes numeric arguments. Though user friendly, method least consistent. Figure 8 shows catalog shapes corresponding numeric argument constructed using ones place x-axis, tens y-axis. example, filled dot, default point shape shown black Figure 6 shape 20. can specify colors R numeric index, name (done), hexadecimal, RGB specification. example col=1 col=\"white\" equivalent. chart Figure 9 produced code developed Glynn (2005). See R Color Chart website details ever need using colors R. Color theory encompasses multitude definitions, concepts design applications - enough fill several encyclopedias. However, three basic categories color theory logical useful : color wheel, color harmony, context colors used. ColorBrewer (Harrower Brewer 2003) online tool (http://colorbrewer2.org/) designed help people select good color schemes maps graphics. encourage use ColorBrewer good, safe introduction selecting colors based theoretically good practices. Figure 8: ggplot2 shape table Figure 9: R colors RColorBrewer package (Neuwirth 2011) simplifies selection ColorBrewer colors R. used RColorBrewer get list colors, assign colors manually specific variable values using ggplot aes() mechanism. ColorBrewer palettes also built ggplot scale_ functions scale_color_brewer function. made extensive use palette=\"Set1\" color palette figures generated. also series scale_color_ functions ggplot2 aid user selecting good color schemes many diﬀerent settings. default, ggplot2 package adds space figures around data. often want remove space, focus smaller window figure. accomplished coord_cartesian function. specifying xlim /ylim coordinates, can crop figure whatever viewport interested without manipulating original dataset. Figure ?? sets origin (0,0) clips x axis 5.1, y axis 101. added .1 1 axis aesthetic reasons avid chopping oﬀ tick labels occur end viewport.  Figure 10: Adjusting viewport second example, recreate figure created PowerPoint plot.sas macro. cases, include points generating presentation figures, figure generated geom_line function calls. also show figure can created single set function calls.","code":"*_____________________________________________________________________; * C G M F I L E S F O R P O W E R P O I N T S L I D E S *_____________________________________________________________________ * Competing risks , parametric only ; filename gsasfile \"&STUDY/graphs/ce.states.ST.cgm \"; %plot(goptions gsfmode =replace , device =cgmmppa , ftext=hwcgm001 , end;   axisx order =(0 to 5 by 1), minor=none , value =( height =2.4) , end;   axisy order =(0 to 100 by 20) , minor=none , value =( height =2.4) ,     value =( height =2.4 j=r ' ' '20 ' '40' '60 ' '80 ' '100 '), end;   tuple set=all , x=years , y=noinit , width =3, color=gray , end;   tuple set=all , x=years , y=nostrk , width =3, color=red , end;   tuple set=all , x=years , y=nodeath , width =3, color=blue , end; ); run; # Install the latest **hvtiPlotR** package. # # # The devtools package is installed on all our # jjnb-gen servers as well as other R instances. # For working on your own install, first use the install command # install.packages(\"devtools\") # Load the package library(\"devtools\") # To get the latest version of hvtiPlotR. install_github(\"ehrlinger/hvtiPlotR\") library(\"foreign\") # The xport file name dtFilename = \"../datasets/par_cst.xpt\" # Read the xport file into a data.frame dta<- read.xport(dtFilename) # Reading in the labels takes 2 more commands. dta.info <- lookup.xport(dtFilename) dta.labels <- dta.info[[1]]$label ## Fill in empty labels with the variable name dta.labels<-sapply(1:length(dta.labels), function(ind){ if(dta.labels[ind] == \"\")   colnames(dta)[ind] else   dta.labels[ind] }) ## For indexing the labels, names(dta.labels) = colnames(dta) # load required libraries library(\"ggplot2\") # Plotting environment library(\"hvtiPlotR\") # CCF HVI plotting functionality  # Load the example datasets data(parametric, package = \"hvtiPlotR\") data(nonparametric, package = \"hvtiPlotR\")  # Set a default hvtiPlotR plotting theme theme_set(hvtiPlotR::hvti_theme(\"manuscript\")) ## To reproduce the plot.sas function, line by line. ###------------- ## There are SAS options we will not use here. # # %plot(goptions gsfmode=replace, device=pscolor, gaccess=gsasfile end; ccf_plot <- ggplot() ###------------- ## Labels are a single command, scales control the axis # # labelx l=\"Years After Randomization\", end; # labely l=\"Percent in Each Category (ST)\", end; ccf_plot <- ccf_plot +   labs(x = \"Years After Randomization\", y = \"Percent in Each Category (ST)\") ###------------- ## Labels are a single command, scales control the axis # # axisx order=(0 to 5 by 1), minor=none, end; # axisy order=(0 to 100 by 10), minor=none, end; ccf_plot <- ccf_plot +   scale_x_continuous(breaks = seq(0, 5, 1)) +   scale_y_continuous(breaks = seq(0, 100, 10)) ###------------- ## /******NON-PARAMETRIC: SYMBOLS AND CONFIDENCE BARS *******/ ## ## Each tuple statement corresponds to one or more geom_ statements # tuple set=green, symbol=dot, symbsize=1/2, linepe=0, linecl=0, # ebarsize=3/4, ebar=1, # x=iv_state, y=sginit, cll=stlinit, clu=stuinit, color=black, end; ccf_plot <- ccf_plot +   geom_point(data = nonparametric, aes(x = iv_state, y = sginit))  show(ccf_plot) # tuple set=green, symbol=circle, symbsize=1/2, linepe=0, linecl=0, # ebarsize=3/4, ebar=1, # x=iv_state, y=sgdead1, cll=stldead1, clu=studead1, color=blue, end; ccf_plot <- ccf_plot +   geom_point(     data = nonparametric,     aes(x = iv_state, y = sgdead1),     color = \"blue\",     shape = 1   ) +   geom_errorbar(     data = nonparametric,     aes(x = iv_state, ymin = stldead1, ymax = studead1),     color = \"blue\",     width = .1   ) # tuple set=green, symbol=square, symbsize=1/2, linepe=0, linecl=0, # ebarsize=3/4, ebar=1, # x=iv_state, y=sgstrk1, cll=stlstrk1, clu=stustrk1, color=blue, end; ccf_plot <- ccf_plot +   geom_point(     data = nonparametric,     aes(x = iv_state, y = sgstrk1),     color = \"blue\",     shape = 0   ) +   geom_errorbar(     data = nonparametric,     aes(x = iv_state, ymin = stlstrk1, ymax = stustrk1),     color = \"blue\",     width = .1   ) show(ccf_plot) Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`). # /**********PARAMETRIC : SOLID LINES AND CONFIDENCE INTERVALS**********/ # tuple set=all, x=years, y=noinit, cll=clinit, clu=cuinit, # width=0.5,color=black, end; ccf_plot <- ccf_plot +   geom_line(data = parametric, aes(x = years, y = noinit)) +   geom_line(data = parametric, aes(x = years, y = clinit), linetype = \"dashed\") +   geom_line(data = parametric, aes(x = years, y = cuinit), linetype = \"dashed\") # # tuple set=all, x=years, y=nodeath, cll=cldeath, clu=cudeath, # width=0.5,color=blue, end; ccf_plot <- ccf_plot +   geom_line(data = parametric,             aes(x = years, y = nodeath),             color = \"blue\") +   geom_line(     data = parametric,     aes(x = years, y = cldeath),     linetype = \"dashed\",     color = \"blue\"   ) +   geom_line(     data = parametric,     aes(x = years, y = cudeath),     linetype = \"dashed\",     color = \"blue\"   ) # # tuple set=all, x=years, y=nostrk, cll=clstrk, clu=custrk, # linecl=2, width=0.5,color=blue, end; ccf_plot <- ccf_plot +   geom_line(data = parametric,             aes(x = years, y = nostrk),             color = \"blue\") +   geom_line(     data = parametric,     aes(x = years, y = clstrk),     linetype = \"dashed\",     color = \"blue\"   ) +   geom_line(     data = parametric,     aes(x = years, y = custrk),     linetype = \"dashed\",     color = \"blue\"   ) show(ccf_plot) Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`). # Special commands to force origin to 0,0 ccf_plot <- ccf_plot +   coord_cartesian(xlim = c(0, 5.1), ylim = c(0, 101)) show(ccf_plot) Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`). # %plot(goptions gsfmode=replace, device=cgmmppa, ftext=hwcgm001, end; #   axisx order=(0 to 5 by 1), minor=none, value=(height=2.4), end; #   axisy order=(0 to 100 by 20), minor=none, value=(height=2.4), #   value=(height=2.4 j=r 20 40 60 80 100 ), end; #   tuple set=all, x=years, y=noinit, width=3, color=gray, end; #   tuple set=all, x=years, y=nostrk, width=3, color=red, end; #   tuple set=all, x=years, y=nodeath, width=3, color=blue, end; # ); ccf_pptPlot <- ggplot() +   scale_x_continuous(breaks = seq(0, 5, 1)) +   scale_y_continuous(breaks = seq(0, 100, 20)) +   geom_line(     data = parametric,     aes(x = years, y = noinit),     color = \"grey\",     size = 1.5   ) +   geom_line(     data = parametric,     aes(x = years, y = nostrk),     color = \"red\",     size = 1.5   ) +   geom_line(     data = parametric,     aes(x = years, y = nodeath),     color = \"blue\",     size = 1.5   ) Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ℹ Please use `linewidth` instead. show(ccf_pptPlot)"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"importing-the-data","dir":"Articles","previous_headings":"","what":"Importing the data","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"document, assume data analysis completed SAS. case, first step creating figures R get data SAS. many ways , success using tp.bd.SAStoR.sas program (datasets folder) export data set SAS xport file. xport file created, read R foreign package. recipe reads xport data.frame re-reads xport file pull SAS labels describe variables. labels stored vector, can index variable names.","code":"library(\"foreign\") # The xport file name dtFilename = \"../datasets/par_cst.xpt\" # Read the xport file into a data.frame dta<- read.xport(dtFilename) # Reading in the labels takes 2 more commands. dta.info <- lookup.xport(dtFilename) dta.labels <- dta.info[[1]]$label ## Fill in empty labels with the variable name dta.labels<-sapply(1:length(dta.labels), function(ind){ if(dta.labels[ind] == \"\")   colnames(dta)[ind] else   dta.labels[ind] }) ## For indexing the labels, names(dta.labels) = colnames(dta)"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"initialize-the-figure","dir":"Articles","previous_headings":"","what":"Initialize the figure","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"Referring back SAS code chunks Section 2, Listing 1 sets current working directory, house keeping, including loading plot.sas macro. Similarly, get started R, first load required libraries: ggplot2 graphics, hvtiPlotR themes. following code chunk also sets initial default theme generic black white format, brings pair example datasets. One advantage ggplot2 figures can built successive statements. tutorial make extensive use demonstrate process. Starting code chunk, save intermediate objects ccf_plot variable. simply create empty ggplot2 figure adding work commands plot.sas macro. Note include %plot() commands comments equivalent ggplot2 command comparison. R, set equivalent variables gsmode, device gaccess saving figure (Section 5).","code":"# load required libraries library(\"ggplot2\") # Plotting environment library(\"hvtiPlotR\") # CCF HVI plotting functionality  # Load the example datasets data(parametric, package = \"hvtiPlotR\") data(nonparametric, package = \"hvtiPlotR\")  # Set a default hvtiPlotR plotting theme theme_set(hvtiPlotR::hvti_theme(\"manuscript\")) ## To reproduce the plot.sas function, line by line. ###------------- ## There are SAS options we will not use here. # # %plot(goptions gsfmode=replace, device=pscolor, gaccess=gsasfile end; ccf_plot <- ggplot()"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"labels","dir":"Articles","previous_headings":"","what":"Labels","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"next section Listing 1 Section 2 sets x y axis titles, well location major axis tick marks. split R code. ggplot2 package uses labs function set axis labels. labs function can also used set plot title legend titles. cover functionality , details available Wickham (2009) Internet.","code":"###------------- ## Labels are a single command, scales control the axis # # labelx l=\"Years After Randomization\", end; # labely l=\"Percent in Each Category (ST)\", end; ccf_plot <- ccf_plot +   labs(x = \"Years After Randomization\", y = \"Percent in Each Category (ST)\")"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"scales","dir":"Articles","previous_headings":"","what":"Scales","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"Axis ticks controlled scale_ functions. ggplot2 many diﬀerent scale_ functions. functions work one axis time, typical continuous axis, use scale_x_continuous scale_y_continuous functions. Major axis controlled using breaks argument. Listing 1 uses sequence numbers set location major tick marks (seq(0,5,1)). One mark every year starting 0, ending 5. Minor tick marks automatically generated, can also specified using minor_breaks= argument. also specify breaks using vector values (c(0,1,2,3,4,5)), well relabel ticks manually using labels= argument. Note scale_ functions restrict figure viewport . simply used setup label axis tick marks. can specify y-axis ticks 0 50, figure blank axis 50 limits data. discuss controlling figure viewport Section 3.11. point, created decorated plot object stored ccf_plot variable. Showing figure (show()) saving figure (ggsave()) result error, since added data object, described want displayed.","code":"###------------- ## Labels are a single command, scales control the axis # # axisx order=(0 to 5 by 1), minor=none, end; # axisy order=(0 to 100 by 10), minor=none, end; ccf_plot <- ccf_plot +   scale_x_continuous(breaks = seq(0, 5, 1)) +   scale_y_continuous(breaks = seq(0, 100, 10))"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"points","dir":"Articles","previous_headings":"","what":"Points","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"fundamental statement plot.sas macro tuple statement. first tuple statement see example code sets data set (set=green), symbol shape (symbol=dot), size (symbsize=1/2) color (color=black). Listing 2 turns oﬀ lines points shown (linepe=0, linecl=0,). also handles error bars (ebarsize=3/4, ebar=1), discuss Section 3.6. last line tells macro point placement using vector x y coordinates. Points displayed paired (x, y) error bars specified matching y values upper (clu) lower (cll) error bar limits (x=iv_state, y=sginit, cll=stlinit, clu=stuinit). geom_ set functions ggplot2 functional equivalent tuple statement. diﬀerence user specifies graphical element desired using separate function calls. points plotting using geom_point function, lines generated geom_line (Section 3.7) error bars generated geom_errorbar function (Section 3.6). functions can take data argument well large set decorator arguments (.e. color, size, shape, linetype, . . . ). aesthetic function (aes()) call used describe point within geom_ function using variable names defined data set. following code chunk demonstrates plotting iv_state variable x-axis sginit variable along y-axis. variables defined nonparametric data set loaded setup code chunk Section 3.  aes() mechanism powerful way communicate data level assignment geom_ functions. want stratify dataset variable, can specify within aes() function call using = argument. points, often want stratifying either diﬀerent color= shape= stratified data. can use scale_color_ functions (See Section 3.10) scale_shape_ functions (See Section 3.9) control assigned stratifying variable. added data ggplot object, can display figure shown Figure 4. now figure manipulated sequentially adding function calls ccf_plot object. display figure can either use show() function, simply call object name command line. Note used default shape, size color figure. can manipulated adding arguments geom_ functions, outside aes() function, demonstrate following sections.","code":"###------------- ## /******NON-PARAMETRIC: SYMBOLS AND CONFIDENCE BARS *******/ ## ## Each tuple statement corresponds to one or more geom_ statements # tuple set=green, symbol=dot, symbsize=1/2, linepe=0, linecl=0, # ebarsize=3/4, ebar=1, # x=iv_state, y=sginit, cll=stlinit, clu=stuinit, color=black, end; ccf_plot <- ccf_plot +   geom_point(data = nonparametric, aes(x = iv_state, y = sginit))  show(ccf_plot)"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"error-bars","dir":"Articles","previous_headings":"","what":"Error Bars","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"Instead using single function set points, lines error bars, ggplot uses individual function calls control elements. geom_errorbar function takes arguments geom_ functions. However, since errorbar defined upper lower limits, need supply ymax ymin argument graphic aesthetic function. code chunk plots points, error bars next two data series, sgdead1 variable error bars running stldead1 studead1 sgstrk1 variable error bars running stlstrk1 stustrk1. see Figure 5, series added color=\"blue\" (Section 3.10), diﬀerent point shapes shape=1 shape=0 series (Section 3.9). manipulated error bar size width argument  Note x variable (iv_state) three data series well associated error bars. requirement, specified diﬀerent variable name geom_ function call. Also note just plot.sas macro, since want error bar placed every data point, large number points upper lower error bar y values set missing (NA). ggplot package print warning messages attempt plot series missing values. typically suppress warnings, left illustration purposes .","code":"# tuple set=green, symbol=circle, symbsize=1/2, linepe=0, linecl=0, # ebarsize=3/4, ebar=1, # x=iv_state, y=sgdead1, cll=stldead1, clu=studead1, color=blue, end; ccf_plot <- ccf_plot +   geom_point(     data = nonparametric,     aes(x = iv_state, y = sgdead1),     color = \"blue\",     shape = 1   ) +   geom_errorbar(     data = nonparametric,     aes(x = iv_state, ymin = stldead1, ymax = studead1),     color = \"blue\",     width = .1   ) # tuple set=green, symbol=square, symbsize=1/2, linepe=0, linecl=0, # ebarsize=3/4, ebar=1, # x=iv_state, y=sgstrk1, cll=stlstrk1, clu=stustrk1, color=blue, end; ccf_plot <- ccf_plot +   geom_point(     data = nonparametric,     aes(x = iv_state, y = sgstrk1),     color = \"blue\",     shape = 0   ) +   geom_errorbar(     data = nonparametric,     aes(x = iv_state, ymin = stlstrk1, ymax = stustrk1),     color = \"blue\",     width = .1   ) show(ccf_plot) Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`)."},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"lines","dir":"Articles","previous_headings":"","what":"Lines","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"Similar points error bars, geom_line function used plot lines. use linetype argument specify line styles (Section 3.8). generate separate geom_line function call limit confidence limit, since constructed two lines (upper lower confidence limit). resulting graph shown Figure 6.  Alternatively, use geom_ribbon generate confidence band using shaded region single call. aesthetic argument geom_ribbon takes ymax ymin argument just geom_errorbar function. Note used diﬀerent data set (data=parametric) use diﬀerent set points generating lines.","code":"# /**********PARAMETRIC : SOLID LINES AND CONFIDENCE INTERVALS**********/ # tuple set=all, x=years, y=noinit, cll=clinit, clu=cuinit, # width=0.5,color=black, end; ccf_plot <- ccf_plot +   geom_line(data = parametric, aes(x = years, y = noinit)) +   geom_line(data = parametric, aes(x = years, y = clinit), linetype = \"dashed\") +   geom_line(data = parametric, aes(x = years, y = cuinit), linetype = \"dashed\") # # tuple set=all, x=years, y=nodeath, cll=cldeath, clu=cudeath, # width=0.5,color=blue, end; ccf_plot <- ccf_plot +   geom_line(data = parametric,             aes(x = years, y = nodeath),             color = \"blue\") +   geom_line(     data = parametric,     aes(x = years, y = cldeath),     linetype = \"dashed\",     color = \"blue\"   ) +   geom_line(     data = parametric,     aes(x = years, y = cudeath),     linetype = \"dashed\",     color = \"blue\"   ) # # tuple set=all, x=years, y=nostrk, cll=clstrk, clu=custrk, # linecl=2, width=0.5,color=blue, end; ccf_plot <- ccf_plot +   geom_line(data = parametric,             aes(x = years, y = nostrk),             color = \"blue\") +   geom_line(     data = parametric,     aes(x = years, y = clstrk),     linetype = \"dashed\",     color = \"blue\"   ) +   geom_line(     data = parametric,     aes(x = years, y = custrk),     linetype = \"dashed\",     color = \"blue\"   ) show(ccf_plot) Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`)."},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"line-types","dir":"Articles","previous_headings":"","what":"Line types","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"linetype argument takes named string value, set diﬀerent line styles. show set frequently used styles Figure 7 reference.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"shapes","dir":"Articles","previous_headings":"","what":"Shapes","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"shape argument takes numeric arguments. Though user friendly, method least consistent. Figure 8 shows catalog shapes corresponding numeric argument constructed using ones place x-axis, tens y-axis. example, filled dot, default point shape shown black Figure 6 shape 20.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"colors","dir":"Articles","previous_headings":"","what":"Colors","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"can specify colors R numeric index, name (done), hexadecimal, RGB specification. example col=1 col=\"white\" equivalent. chart Figure 9 produced code developed Glynn (2005). See R Color Chart website details ever need using colors R. Color theory encompasses multitude definitions, concepts design applications - enough fill several encyclopedias. However, three basic categories color theory logical useful : color wheel, color harmony, context colors used. ColorBrewer (Harrower Brewer 2003) online tool (http://colorbrewer2.org/) designed help people select good color schemes maps graphics. encourage use ColorBrewer good, safe introduction selecting colors based theoretically good practices. Figure 8: ggplot2 shape table Figure 9: R colors RColorBrewer package (Neuwirth 2011) simplifies selection ColorBrewer colors R. used RColorBrewer get list colors, assign colors manually specific variable values using ggplot aes() mechanism. ColorBrewer palettes also built ggplot scale_ functions scale_color_brewer function. made extensive use palette=\"Set1\" color palette figures generated. also series scale_color_ functions ggplot2 aid user selecting good color schemes many diﬀerent settings.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"global-figure-commands","dir":"Articles","previous_headings":"","what":"Global Figure Commands","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"default, ggplot2 package adds space figures around data. often want remove space, focus smaller window figure. accomplished coord_cartesian function. specifying xlim /ylim coordinates, can crop figure whatever viewport interested without manipulating original dataset. Figure ?? sets origin (0,0) clips x axis 5.1, y axis 101. added .1 1 axis aesthetic reasons avid chopping oﬀ tick labels occur end viewport.  Figure 10: Adjusting viewport","code":"# Special commands to force origin to 0,0 ccf_plot <- ccf_plot +   coord_cartesian(xlim = c(0, 5.1), ylim = c(0, 101)) show(ccf_plot) Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`)."},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"powerpoint-figures","dir":"Articles","previous_headings":"","what":"PowerPoint Figures","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"second example, recreate figure created PowerPoint plot.sas macro. cases, include points generating presentation figures, figure generated geom_line function calls. also show figure can created single set function calls.","code":"# %plot(goptions gsfmode=replace, device=cgmmppa, ftext=hwcgm001, end; #   axisx order=(0 to 5 by 1), minor=none, value=(height=2.4), end; #   axisy order=(0 to 100 by 20), minor=none, value=(height=2.4), #   value=(height=2.4 j=r 20 40 60 80 100 ), end; #   tuple set=all, x=years, y=noinit, width=3, color=gray, end; #   tuple set=all, x=years, y=nostrk, width=3, color=red, end; #   tuple set=all, x=years, y=nodeath, width=3, color=blue, end; # ); ccf_pptPlot <- ggplot() +   scale_x_continuous(breaks = seq(0, 5, 1)) +   scale_y_continuous(breaks = seq(0, 100, 20)) +   geom_line(     data = parametric,     aes(x = years, y = noinit),     color = \"grey\",     size = 1.5   ) +   geom_line(     data = parametric,     aes(x = years, y = nostrk),     color = \"red\",     size = 1.5   ) +   geom_line(     data = parametric,     aes(x = years, y = nodeath),     color = \"blue\",     size = 1.5   ) Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ℹ Please use `linewidth` instead. show(ccf_pptPlot)"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"ggplot2-themes-for-publication","dir":"Articles","previous_headings":"","what":"ggplot2 themes for publication","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"themes system ggplot enables user control non-data elements ggplot object. use color palettes (Section 3.10), shapes (Section 3.9) linetypes (Section 3.8) control data elements, use themes control visual details remaining aspects figures. hvtiPlotR package contains two custom themes. {hvti_theme(“manuscript”)} theme used manuscripts, {hvti_theme(“ppt”)} {theme_ppt()} themes used powerpoint documents. themes can applied figure created using ggplot2 package. , multiple ways assign theme use. Using theme_set() function apply theme subsequent figures. Even figure created theme_set call, displaying figure call apply new theme. best revert default theme end section. following code chunk demonstrates process using manuscript theme (hvti_theme(“manuscript”)). resulting manuscript graphic show Figure 12.  Note plotting figure show Figure ??. However, modified box around plot window well made minor modifications targeted creating publication quality graphics. example, apply powerpoint theme eﬀect figure constructed Figure 11. code chunk removes x y axis label, since prefer add within PowerPoint directly. results shown Figure 13.  theme presentations significantly diﬀerent showed Figure 11. Since presentations displayed blue background, changed axis tick labels white. axis labels, frame tick mark , invisible background changes slide background visible figure. see full eﬀect, modify theme plot background “transparent” “blue” Figure 13.","code":"# Set the theme for manuscripts, theme_set(hvti_theme(\"manuscript\")) # show the figure. ccf_plot Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`). # Update the PowerPoint Figure to include the PPT Theme, and remove axis labels.  # Axis labels will be added manually in powerpoint.  ccf_pptPlot <- ccf_pptPlot +    hvti_theme(\"ppt\") ccf_pptPlot # Show the figure... the theme statement is used so the axis tick marks and values  # are visible in this document.  ccf_pptPlot + theme(plot.background = element_rect(fill='blue', colour='blue'))"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"theme-for-manuscripts","dir":"Articles","previous_headings":"","what":"Theme for Manuscripts","title":"The hvtiPlotR package: Generating plot.sas style in R","text":", multiple ways assign theme use. Using theme_set() function apply theme subsequent figures. Even figure created theme_set call, displaying figure call apply new theme. best revert default theme end section. following code chunk demonstrates process using manuscript theme (hvti_theme(“manuscript”)). resulting manuscript graphic show Figure 12.  Note plotting figure show Figure ??. However, modified box around plot window well made minor modifications targeted creating publication quality graphics.","code":"# Set the theme for manuscripts, theme_set(hvti_theme(\"manuscript\")) # show the figure. ccf_plot Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`)."},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"theme-for-presentations","dir":"Articles","previous_headings":"","what":"Theme for Presentations","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"example, apply powerpoint theme eﬀect figure constructed Figure 11. code chunk removes x y axis label, since prefer add within PowerPoint directly. results shown Figure 13.  theme presentations significantly diﬀerent showed Figure 11. Since presentations displayed blue background, changed axis tick labels white. axis labels, frame tick mark , invisible background changes slide background visible figure. see full eﬀect, modify theme plot background “transparent” “blue” Figure 13.","code":"# Update the PowerPoint Figure to include the PPT Theme, and remove axis labels.  # Axis labels will be added manually in powerpoint.  ccf_pptPlot <- ccf_pptPlot +    hvti_theme(\"ppt\") ccf_pptPlot # Show the figure... the theme statement is used so the axis tick marks and values  # are visible in this document.  ccf_pptPlot + theme(plot.background = element_rect(fill='blue', colour='blue'))"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"mirrored-propensity-score-histogram","dir":"Articles","previous_headings":"","what":"Mirrored Propensity Score Histogram","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"common figure propensity-matched analyses mirrored histogram, displays propensity score distributions two treatment groups matching. hvtiPlotR package provides mirror_histogram() function generate figure. function accepts data frame columns propensity score, group indicator, match indicator. sample_mirror_histogram_data() function generates example data suitable testing.  lighter bars show full (pre-match) propensity score distribution group, darker overlaid bars show matched subset. upper panel corresponds first group label lower panel second. function also returns diagnostics summarising group counts standardized mean differences (SMD) matching:","code":"# Generate sample data for the mirrored histogram mirror_dta <- sample_mirror_histogram_data(n = 2000)  # Generate the mirrored histogram mhist <- mirror_histogram(   data = mirror_dta,   score_col = \"prob_t\",   group_col = \"tavr\",   match_col = \"match\",   group_levels = c(0, 1),   group_labels = c(\"SAVR\", \"TF-TAVR\"),   matched_value = 1,   score_multiplier = 100,   binwidth = 5 )  # Display the plot mhist$plot # Standardized mean difference before matching mhist$diagnostics$smd_before [1] 2.677426 # Standardized mean difference after matching mhist$diagnostics$smd_matched [1] 2.679721 # Group counts before matching mhist$diagnostics$group_counts_before 0    1 2000 2000 # Group counts after matching mhist$diagnostics$group_counts_matched 0    1 1209 1197"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"saving-publication-graphics","dir":"Articles","previous_headings":"","what":"Saving publication graphics","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"created figure, formatted desired (using hvtiPlotR theme), need save figure format can easily imported publications. best practice include footnote containing figure path figure save. way, user sends file collaborator, can reverse engineer file generating code resides case changes required. use gridExtra package (Auguie 2012) add footnote following recipe. Figure ?? uses plot Figure 12 code ccf_plot+hvti_theme(\"manuscript\"). current working directory obtained using getwd() function. Sys.Date() function returns system date timestamping figure. footnote placed x = 0, hjust = -.1, vjust=.01, formatted gp = gpar(fontface = \"italic\", fontsize = 6). Word documents (Oﬃce ≥ 2007) can import PDF graphics vector based format. Saving figure accomplished using either ggsave() function, pdf(); show(); dev.() combination. specific set width height dimensions required saving figure footnote included get font sizes import correctly Word. ggsave(filename=\"manuscript.pdf\", height=4, width=5, ccf_savePlot) use ReporteRs package (Gohel 2014) insert vector based figures R PowerPoint documents. latest version ReporteRs package available http://davidgohel.github.io/ReporteRs/. install package installed hvtiPlotR package. Basically, package works opening saved PowerPoint Presentation, inserting new slides containing graphs tables document. resulting document saved new presentation. pass presentation collaborators, copy paste ggplot2 slides presentations. ggplot2 graphics inserted presentation converted editable vector based format. document edited PowerPoint, graphical components like points, lines, text can easily modified match presenters style. following code block R recipe saving ccf_pptPlot created Section 4.2. modification possibly require recipe may moving insertion point (offx offy arguments) /size (width height) figure addPlot() function call.","code":"library(\"grid\")  library(\"gridExtra\") ccf_savePlot <- arrangeGrob(ccf_plot + hvti_theme(\"manuscript\"),                             sub = textGrob(                               paste(getwd(), Sys.Date(), sep = \" \"),                               x = 0,                               hjust = -.1,                               vjust = .01,                               gp = gpar(fontface = \"italic\", fontsize = 6)                             )) Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`). ccf_savePlot TableGrob (2 x 1) \"arrange\": 2 grobs     z     cells    name                grob     1 (1-1,1-1) arrange      gtable[layout] sub 2 (2-2,1-1) arrange text[GRID.text.382] # Install the latest ReporteRs package.  #  # The devtools package is installed on all our  # jjnb-gen servers as well as other R instances.  library(\"devtools\") Loading required package: usethis # To get the latest version.  #install_github(\"davidgohel/ReporteRs\") # library(\"ReporteRs\")   #    # # Create a powerPoint document using ../inst/RDPresentation.pptx   # # as a template document.   # doc = pptx(template = paste(\"../inst/RDPresentation.pptx\", sep = \"\"))   # # Here we define powerpoint document filename to write   # # the presentation. This will be overwritten   # pptx.file = paste(\"RDExample.pptx\", sep = \"\")   # ##--------   # # For each graph, addSlide. The graphs require the   # # “Title and Content” template.   # doc = addSlide(doc, \"Title and Content\")   # # Place a title   # doc = addTitle(doc, \"Treatment Difference\")   # # Now add the graph into the powerPoint doc   # doc = addPlot(   #   doc = doc,   #   fun = print,   #   x = ccf_pptPlot + theme_ppt() ,   #   editable = TRUE,   #   offx = .75,   #   offy = 1.1,   #   width = 8,   #   height = 6   # )   # ##--------   # ##--------   # ## IF you want to add more, just` repeat between the   # ##-------- comments \\# write the output powerpoint doc.   # # This will not overwrite an open document, since open PPT files are locked.   # writeDoc(doc, pptx.file)"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"manuscript-graphics","dir":"Articles","previous_headings":"","what":"Manuscript graphics","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"best practice include footnote containing figure path figure save. way, user sends file collaborator, can reverse engineer file generating code resides case changes required. use gridExtra package (Auguie 2012) add footnote following recipe. Figure ?? uses plot Figure 12 code ccf_plot+hvti_theme(\"manuscript\"). current working directory obtained using getwd() function. Sys.Date() function returns system date timestamping figure. footnote placed x = 0, hjust = -.1, vjust=.01, formatted gp = gpar(fontface = \"italic\", fontsize = 6). Word documents (Oﬃce ≥ 2007) can import PDF graphics vector based format. Saving figure accomplished using either ggsave() function, pdf(); show(); dev.() combination. specific set width height dimensions required saving figure footnote included get font sizes import correctly Word. ggsave(filename=\"manuscript.pdf\", height=4, width=5, ccf_savePlot)","code":"library(\"grid\")  library(\"gridExtra\") ccf_savePlot <- arrangeGrob(ccf_plot + hvti_theme(\"manuscript\"),                             sub = textGrob(                               paste(getwd(), Sys.Date(), sep = \" \"),                               x = 0,                               hjust = -.1,                               vjust = .01,                               gp = gpar(fontface = \"italic\", fontsize = 6)                             )) Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_point()`). Warning: Removed 117 rows containing missing values or values outside the scale range (`geom_point()`). ccf_savePlot TableGrob (2 x 1) \"arrange\": 2 grobs     z     cells    name                grob     1 (1-1,1-1) arrange      gtable[layout] sub 2 (2-2,1-1) arrange text[GRID.text.382]"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"powerpoint-graphics","dir":"Articles","previous_headings":"","what":"PowerPoint graphics","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"use ReporteRs package (Gohel 2014) insert vector based figures R PowerPoint documents. latest version ReporteRs package available http://davidgohel.github.io/ReporteRs/. install package installed hvtiPlotR package. Basically, package works opening saved PowerPoint Presentation, inserting new slides containing graphs tables document. resulting document saved new presentation. pass presentation collaborators, copy paste ggplot2 slides presentations. ggplot2 graphics inserted presentation converted editable vector based format. document edited PowerPoint, graphical components like points, lines, text can easily modified match presenters style. following code block R recipe saving ccf_pptPlot created Section 4.2. modification possibly require recipe may moving insertion point (offx offy arguments) /size (width height) figure addPlot() function call.","code":"# Install the latest ReporteRs package.  #  # The devtools package is installed on all our  # jjnb-gen servers as well as other R instances.  library(\"devtools\") Loading required package: usethis # To get the latest version.  #install_github(\"davidgohel/ReporteRs\") # library(\"ReporteRs\")   #    # # Create a powerPoint document using ../inst/RDPresentation.pptx   # # as a template document.   # doc = pptx(template = paste(\"../inst/RDPresentation.pptx\", sep = \"\"))   # # Here we define powerpoint document filename to write   # # the presentation. This will be overwritten   # pptx.file = paste(\"RDExample.pptx\", sep = \"\")   # ##--------   # # For each graph, addSlide. The graphs require the   # # “Title and Content” template.   # doc = addSlide(doc, \"Title and Content\")   # # Place a title   # doc = addTitle(doc, \"Treatment Difference\")   # # Now add the graph into the powerPoint doc   # doc = addPlot(   #   doc = doc,   #   fun = print,   #   x = ccf_pptPlot + theme_ppt() ,   #   editable = TRUE,   #   offx = .75,   #   offy = 1.1,   #   width = 8,   #   height = 6   # )   # ##--------   # ##--------   # ## IF you want to add more, just` repeat between the   # ##-------- comments \\# write the output powerpoint doc.   # # This will not overwrite an open document, since open PPT files are locked.   # writeDoc(doc, pptx.file)"},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"graphics-rules-to-live-by","dir":"Articles","previous_headings":"","what":"Graphics rules to live by","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"section progress. . .","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"conclusions","dir":"Articles","previous_headings":"","what":"Conclusions","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"article, present hvtiPlotR package R. package made ggplot2 themes publication quality graphics, well tutorial document included package vignette. package available https://github.com/ehrlinger/hvtiPlotR can installed using devtools::install_github(\"ehrlinger/hvtiPlotR\") command.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"Auguie B (2012). gridExtra: functions Grid graphics. R package version 0.9.1, URL http://CRAN.R-project.org/package=gridExtra. Glynn EF (2005). “R Color Chart.” http://research.stowers-institute.org/efg/R/ Color/Chart/index.htm. Accessed: 2014-09-16. Gohel D (2014). ReporteRs: Microsoft Word, Microsoft Powerpoint HTML docu- ments generation R. R package version 0.6.1, URL http://davidgohel.github. io/ReporteRs/index.html,http://groups.google.com/group/reporters-package. Harrower M, Brewer CA (2003). “ColorBrewer.org: Online Tool Selecting Colour Schemes Maps.” Cartographic Journal, pp. 27–37. doi:10.1179/ 000870403235002042. URL http://colorbrewer2.org/. Neuwirth E (2011). RColorBrewer: ColorBrewer palettes. R package version 1.0-5, URL http://CRAN.R-project.org/package=RColorBrewer. Wickham H (2009). ggplot2: elegant graphics data analysis. Springer New York. ISBN 978-0-387-98140-6. Wilkinson L (2005). Grammar Graphics (Statistics Computing). Springer-Verlag New York, Inc., Secaucus, NJ, USA. ISBN 0387245448.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.html","id":"aﬃliation","dir":"Articles","previous_headings":"","what":"Aﬃliation:","title":"The hvtiPlotR package: Generating plot.sas style in R","text":"John Ehrlinger Heart, Vascular Thoracic Institute Cleveland Clinic 9500 Euclid Ave Cleveland, Ohio 44195 E-mail: ehrlinj@ccf.org URL: http://www.lerner.ccf.org/qhs/people/ehrlinj/ URL: https://github.com/ehrlinger/hvtiPlotR","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"John Ehrlinger. Author, maintainer.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ehrlinger J (2026). hvtiPlotR: Porting \"plot.sas\" macro R Using ggplot2 officer Packages. R package version 1.0.6, https://github.com/ehrlinger/hvtiPlotR.","code":"@Manual{,   title = {hvtiPlotR: Porting the \"plot.sas\" macro to R Using ggplot2 and officer Packages},   author = {John Ehrlinger},   year = {2026},   note = {R package version 1.0.6},   url = {https://github.com/ehrlinger/hvtiPlotR}, }"},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"the-hvtiplotr-package","dir":"","previous_headings":"","what":"The hvtiPlotR package","title":"Porting the ","text":"ggplot2 themes methodology documentation creating publication quality graphics R conforming standards clinical investigations statistics group within Heart & Vascular Institute Cleveland Clinic. hvtiPlotR package modern R implementation historical plot.sas macro. provides: cohesive ggplot2 theme family accessible hvti_theme() generic (e.g., hvti_theme(\"ppt\"), hvti_theme(\"manuscript\")). Convenience theme aliases: theme_manuscript() / theme_man(), theme_ppt(), theme_poster(), theme_dark_ppt(). Mirrored propensity score histograms via mirror_histogram(). Helpers exporting plots PowerPoint (powered officer) via save_ppt().","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Porting the ","text":"Install GitHub using remotes: load package R session:","code":"remotes::install_github(\"ehrlinger/hvtiPlotR\") library(hvtiPlotR)"},{"path":[]},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"themes","dir":"","previous_headings":"Usage Overview","what":"Themes","title":"Porting the ","text":"Use unified theme generic apply styles aligned HVI publication standards:","code":"library(ggplot2) p <- ggplot(mtcars, aes(wt, mpg, color = factor(cyl))) + geom_point()  # Via generic p + hvti_theme(\"manuscript\") p + hvti_theme(\"ppt\")  # Or using the exported aliases directly p + theme_manuscript() p + theme_man() p + theme_ppt() p + theme_poster() p + theme_dark_ppt()"},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"mirrored-propensity-score-histograms","dir":"","previous_headings":"Usage Overview","what":"Mirrored Propensity Score Histograms","title":"Porting the ","text":"hvti_plot() generic also available alternative entry point:","code":"dta <- sample_mirror_histogram_data(n = 2000)  mhist <- mirror_histogram(   data = dta,   group_labels = c(\"SAVR\", \"TF-TAVR\") )  mhist$plot        # ggplot object mhist$diagnostics # SMD + group count tables mhist$data        # filtered data frame used for plotting mhist <- hvti_plot(\"mirror_histogram\", data = dta, group_labels = c(\"SAVR\", \"TF-TAVR\"))"},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"powerpoint-export","dir":"","previous_headings":"Usage Overview","what":"PowerPoint Export","title":"Porting the ","text":"","code":"template <- system.file(\"ClevelandClinic.pptx\", package = \"hvtiPlotR\")  save_ppt(   object      = mhist$plot,   template    = template,   powerpoint  = \"outputs/analysis.pptx\",   slide_title = \"Propensity Balance\" )"},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"development-workflow","dir":"","previous_headings":"","what":"Development Workflow","title":"Porting the ","text":"Clone repo install dependencies: renv::restore() pak::pak() (optional). Run unit tests: Check package:","code":"devtools::test() devtools::check()"},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"test-coverage-highlights","dir":"","previous_headings":"Development Workflow","what":"Test Coverage Highlights","title":"Porting the ","text":"tests/testthat/test_mirror_histogram.R: validates helper calculations, diagnostics, error handling, hvti_plot() dispatch. tests/testthat/test_save_ppt.R: covers happy paths plus validation failure scenarios PowerPoint exports. tests/testthat/test_footnote.R: ensures makeFootnote() works across plotting contexts rejects invalid inputs.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"vignettes-and-extended-docs","dir":"","previous_headings":"","what":"Vignettes and Extended Docs","title":"Porting the ","text":"See vignettes/hvtiPlotR.qmd end--end recipes mirroring original HVI guidelines. Historical SAS macro documentation remains inst/plot.README reference; modern workflows live R package.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Porting the ","text":"Pull requests welcome! Please: Create feature branch master. Add tests new functionality. Run devtools::check() locally. Update NEWS file change user-facing behavior.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Porting the ","text":"project adheres Contributor Covenant. participating, expected uphold code.","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/news/index.html","id":"hvtiplotr-022","dir":"Changelog","previous_headings":"","what":"hvtiPlotR 0.2.2","title":"hvtiPlotR 0.2.2","text":"Fixed deprecated ggplot2 syntax (size -> linewidth element_line element_rect) Removed empty save.hviplotr function Fixed theme_dark_ppt pass parameters theme_grey Updated documentation data objects Updated README reference officer package instead deprecated ReporteRs","code":""},{"path":"http://ehrlinger.github.io/hviPlotR/news/index.html","id":"hvtiplotr-020","dir":"Changelog","previous_headings":"","what":"hvtiPlotR 0.2.0","title":"hvtiPlotR 0.2.0","text":"Initial CRAN submission.","code":""}]
