## The hvtiPlotR package

ggplot2 themes and methodology documentation for creating publication
quality graphics in *R* conforming to the standards of the clinical
investigations statistics group within The Heart & Vascular Institute at
the Cleveland Clinic.

The *hvtiPlotR* package is the modern *R* implementation of the
historical *plot.sas* macro. It provides:

- A cohesive ggplot2 theme family accessible through the `hvti_theme()`
  generic (e.g., `hvti_theme("ppt")`, `hvti_theme("manuscript")`).
- Convenience theme aliases: `theme_manuscript()` / `theme_man()`,
  `theme_ppt()`, `theme_poster()`, `theme_dark_ppt()`.
- Mirrored propensity score histograms via `mirror_histogram()`.
- Helpers for exporting plots to PowerPoint (powered by `officer`) via
  `save_ppt()`.

## Installation

Install from GitHub using
[remotes](https://CRAN.R-project.org/package=remotes):

``` r
remotes::install_github("ehrlinger/hvtiPlotR")
```

Then load the package in your R session:

``` r
library(hvtiPlotR)
```

## Usage Overview

### Themes

Use the unified theme generic to apply styles aligned with HVI
publication standards:

``` r
library(ggplot2)
p <- ggplot(mtcars, aes(wt, mpg, color = factor(cyl))) + geom_point()

# Via generic
p + hvti_theme("manuscript")
p + hvti_theme("ppt")

# Or using the exported aliases directly
p + theme_manuscript()
p + theme_man()
p + theme_ppt()
p + theme_poster()
p + theme_dark_ppt()
```

### Mirrored Propensity Score Histograms

``` r
dta <- sample_mirror_histogram_data(n = 2000)

mhist <- mirror_histogram(
  data = dta,
  group_labels = c("SAVR", "TF-TAVR")
)

mhist$plot        # ggplot object
mhist$diagnostics # SMD + group count tables
mhist$data        # filtered data frame used for plotting
```

The `hvti_plot()` generic is also available as an alternative entry
point:

``` r
mhist <- hvti_plot("mirror_histogram", data = dta, group_labels = c("SAVR", "TF-TAVR"))
```

### PowerPoint Export

``` r
template <- system.file("ClevelandClinic.pptx", package = "hvtiPlotR")

save_ppt(
  object      = mhist$plot,
  template    = template,
  powerpoint  = "outputs/analysis.pptx",
  slide_title = "Propensity Balance"
)
```

## Development Workflow

1.  Clone the repo and install dependencies: `renv::restore()` or
    [`pak::pak()`](https://pak.r-lib.org/reference/pak.html) (optional).
2.  Run the unit tests:

``` r
devtools::test()
```

3.  Check the package:

``` r
devtools::check()
```

### Test Coverage Highlights

- `tests/testthat/test_mirror_histogram.R`: validates helper
  calculations, diagnostics, error handling, and `hvti_plot()` dispatch.
- `tests/testthat/test_save_ppt.R`: covers happy paths plus all
  validation and failure scenarios for PowerPoint exports.
- `tests/testthat/test_footnote.R`: ensures `makeFootnote()` works
  across plotting contexts and rejects invalid inputs.

## Vignettes and Extended Docs

- See `vignettes/hvtiPlotR.qmd` for end-to-end recipes mirroring the
  original HVI guidelines.
- Historical SAS macro documentation remains under `inst/plot.README`
  for reference; all modern workflows live in the R package.

## Contributing

Pull requests are welcome! Please:

1.  Create a feature branch from `master`.
2.  Add tests for any new functionality.
3.  Run
    [`devtools::check()`](https://devtools.r-lib.org/reference/check.html)
    locally.
4.  Update the NEWS file if you change user-facing behavior.

## Code of Conduct

This project adheres to the [Contributor
Covenant](https://www.contributor-covenant.org/version/2/1/code_of_conduct/).
By participating, you are expected to uphold this code.

# 

# Articles

### All vignettes

- [The \*\*hvtiPlotR\*\* package: Generating plot.sas style in
  R](http://ehrlinger.github.io/hviPlotR/articles/hvtiPlotR.md):
